var sura,properties,courses=["Introduction","Syllables","Phases","Philosophy"];function openLastCategory(){var e=getCookie("last-category");null!=e&&($("#categories").val(e),$("#categories").trigger("change"))}function createControls(){$("#controlsContainer").append('\n    <table class="properties">\n      <tr class="titlebar">\n        <td colspan="2">\n          <span class="param title">\n            <strong>Properties<span id="changed" class="hidden"><sup>*</sup></span></strong>\n          </span>\n          <span class="value titlebar-buttons">\n            <span>\n              <input type="button" id="cmd_ok" class="button titlebar-button" name="cmd_ok" value="Apply">\n            </span>\n            <span>\n              <input type="button" id="cmd_reset" class="button titlebar-button" name="cmd_reset" value="Reset">\n            </span>\n          </span>\n        </td>\n      </tr>\n      <tr class="categories-selector">\n        <td colspan="2">\n          <select id="categories">\n            <option value="none" selected disabled>(Please select)</option>\n          </select>\n        </td>\n      </tr>\n    </table>\n  ');$.each({Lessons:{Introduction:["number","array",{none:-1,Syllables:0,Voices:3,Characters:2,Score:1}],Syllables:["number","array",{none:-1,syllableTypes:0,syllableRotation:1,syllableTruthGrid:2}],Phases:["number","array",{none:-1,elements:0,radicals:1,roots:2,words:3}],Philosophy:["number","array",{none:-1,noumena:0,phenomena:1}]},EnableDisableCommands:{truthGridEnabled:["boolean","array",{False:!1,True:!0}],syllablesEnabled:["boolean","array",{False:!1,True:!0}],voicesEnabled:["boolean","array",{False:!1,True:!0}],circlesEnabled:["boolean","array",{False:!1,True:!0}],charactersEnabled:["boolean","array",{False:!1,True:!0}],scoreEnabled:["boolean","array",{False:!1,True:!0}]},DiverseCommands:{priority:["number","type","priorities"],metronomeEnabled:["boolean","array",{False:!1,True:!0}]},BehaviourCommands:{unit:["number","array",{Default:40,Small:30,Large:65}],endLevel:["number","array",{"One Group":3,"Two Groups":7,"Three Groups (Time 24h)":11,"Four Groups":15,"Five Groups (Default)":19}],startExcerptCharacters:["number","array",{firstGroup:0,secondGroup:4,thirdGroup:8}],endExcerptCharacters:["number","array",{firstGroup:3,secondGroup:7,thirdGroup:11,fourthGroup:15,fifthGroup:19}],startExcerptVoices:["number","array",{firstGroup:0,secondGroup:4,thirdGroup:8}],endExcerptVoices:["number","array",{firstGroup:3,secondGroup:7,thirdGroup:11,fourthGroup:15,fifthGroup:19}]},AppearanceCommands:{colors:["sarray","array",{Default:["#4682B4","#3CB371","#800000","#FFD700","#8A2BE2","#2F4F4F"],HighContrast:["#212F3C","#3CB371","#800000","#FFD700","#8A2BE2","#2F4F4F"]}]},ColorCodingCommands:{syllablesColorCodingMode:["number","type","syllablesColorCodingModes"],charactersColorCodingMode:["number","type","charactersColorCodingModes",{someElements:"markElements",someLevels:"markLevels",someComponentCycles:"markLevels",allPhases:"phaseMode"}],phaseMode:["number","type","phases"],markElements:["array","array",{0:"[0]",H:"[1]",A:"[2]",Z:"[3]",V:"[4]",I:"[5]","A + V":"[2, 4]","0 + H + I":"[0, 1, 5]"}],markLevels:["array","array",{None:"[]",First:"[1]",Second:"[2]",Third:"[3]",Fourth:"[4]","First + Second":"[1, 2]","Second + Third":"[2, 3]","Third + Fourth":"[3, 4]"}],voicesColorCodingMode:["number","type","voicesColorCodingModes"]}},function(e,o){addCategory(e),$.each(o,function(o,r){var t=r[0],n=r[1],a="";switch(void 0!==r[3]&&(a=JSON.stringify(r[3])),n){case"type":addCommand(o,sura[r[2]],t,e,a);break;case"array":addCommand(o,r[2],t,e,a)}})})}function addCategory(e){$("#categories").append('<option value="'+e+'">'+e+"</option>")}function addCommand(e,o,r,t,n){var a='<select class="command" id="'+e+'" datatype="'+r+"\" dependencies='"+n+"'>",s=0;$.each(o,function(e,o){a+='<option value="'+o+'" key="'+e+'">',a+=s+" - "+e,a+="</option>",s++}),a+="</select>",$("#controlsContainer table").append('<tr class="categories '+t+' hidden"><td class="param" title="'+e+'">'+e+'</td><td class="value">'+a+"</td></tr>")}function loadConfiguration(){var e={user:user};$.post("controller/configuration_retrieve.php",e,function(e){if(!(e.length<2)){var o,r;e=(e=JSON.parse(e))[1];var t=JSON.parse(e);$.each(t,function(e,t){o=t[0],r=t[1],$("#"+o).val(r)}),markChanged(!1),openLastCategory()}})}function markChanged(e){void 0===e&&(e=!0),e?$("#changed").removeClass("hidden"):$("#changed").addClass("hidden")}function resetCommandHints(){$(".param").css("text-decoration","none")}function setCommandHint(e){$('.param[title="'+e+'"]').css("text-decoration","underline")}function loadEvents(){$("#categories").on("change",function(){var e=$("#categories option:selected").val();$(".categories").addClass("hidden"),$("."+e).removeClass("hidden"),setCookie("last-category",e,7)}),$(".command").on("change",function(){var e=$(this).attr("dependencies"),o=$(this).attr("id"),r=$(this).find(":selected").attr("key");!function(e,o){if(r=e,!($.inArray(r,courses)>-1))return;var r;$("#truthGridEnabled option[key='True']").prop("selected",!1),$("#syllablesEnabled option[key='True']").prop("selected",!1),$("#voicesEnabled option[key='True']").prop("selected",!1),$("#circlesEnabled option[key='True']").prop("selected",!1),$("#charactersEnabled option[key='True']").prop("selected",!1),$("#scoreEnabled option[key='True']").prop("selected",!1),$("#priority option[key^='characters']").prop("selected",!0),$("#metronomeEnabled option[key='False']").prop("selected",!0),$("#unit option[key='Default']").prop("selected",!0),$("#endLevel option[key^='Four']").prop("selected",!0),$("#startExcerptCharacters option[key^='first']").prop("selected",!0),$("#endExcerptCharacters option[key^='fifth']").prop("selected",!0),$("#startExcerptVoices option[key^='first']").prop("selected",!0),$("#endExcerptVoices option[key^='fifth']").prop("selected",!0),$("#colors option[key^='Default']").prop("selected",!0),$("#syllablesColorCodingMode option[key^='none']").prop("selected",!0),$("#charactersColorCodingMode option[key^='none']").prop("selected",!0),$("#phasegMode option[key^='none']").prop("selected",!0),$("#markElements option[key^='0']").prop("selected",!0),$("#markLevels option[key^='none']").prop("selected",!0),$("#voicesColorCodingMode option[key^='none']").prop("selected",!0),t=e,$.each(courses,function(e,o){t!=o&&$("#"+o+" option[key^='none']").prop("selected",!0)}),"Introduction"==e?"0"==o?($("#priority option[key^='voices']").prop("selected",!0),$("#syllablesEnabled option[key='True']").prop("selected",!0),$("#syllablesColorCodingMode option[key^='none']").prop("selected",!0)):"1"==o?($("#priority option[key^='voices']").prop("selected",!0),$("#unit option[key='Large']").prop("selected",!0),$("#endLevel option[key^='Three']").prop("selected",!0),$("#scoreEnabled option[key='True']").prop("selected",!0),$("#circlesEnabled option[key='True']").prop("selected",!0)):"2"==o?($("#priority option[key^='characters']").prop("selected",!0),$("#charactersEnabled option[key='True']").prop("selected",!0),$("#charactersColorCodingMode option[key^='none']").prop("selected",!0)):"3"==o&&($("#priority option[key^='voices']").prop("selected",!0),$("#voicesEnabled option[key='True']").prop("selected",!0),$("#circlesEnabled option[key='True']").prop("selected",!0),$("#voicesColorCodingMode option[key^='none']").prop("selected",!0)):"Syllables"==e?($("#priority option[key^='voices']").prop("selected",!0),"0"==o?($("#syllablesEnabled option[key='True']").prop("selected",!0),$("#syllablesColorCodingMode option[key^='allSyllables']").prop("selected",!0)):"1"==o?($("#syllablesEnabled option[key='True']").prop("selected",!0),$("#circlesEnabled option[key='True']").prop("selected",!0),$("#syllablesColorCodingMode option[key^='none']").prop("selected",!0)):"2"==o&&($("#truthGridEnabled option[key='True']").prop("selected",!0),$("#syllablesEnabled option[key='True']").prop("selected",!0),$("#syllablesColorCodingMode option[key^='none']").prop("selected",!0))):"Phases"==e?($("#charactersEnabled option[key='True']").prop("selected",!0),$("#charactersColorCodingMode option[key^='allPhases']").prop("selected",!0),$("#colors option[key^='HighContrast']").prop("selected",!0),$("#priority option[key^='characters']").prop("selected",!0),"0"==o?$("#phaseMode option[key^='elements']").prop("selected",!0):"1"==o?$("#phaseMode option[key^='radicals']").prop("selected",!0):"2"==o?$("#phaseMode option[key^='roots']").prop("selected",!0):"3"==o&&$("#phaseMode option[key^='words']").prop("selected",!0)):"Philosophy"==e&&($("#charactersEnabled option[key='True']").prop("selected",!0),$("#voicesEnabled option[key='True']").prop("selected",!0),$("#circlesEnabled option[key='True']").prop("selected",!0),"0"==o?$("#priority option[key^='characters']").prop("selected",!0):"1"==o&&$("#priority option[key^='voices']").prop("selected",!0));var t}(o,$(this).find(":selected").attr("value")),resetCommandHints(),""!=e&&(e=JSON.parse(e),$.each(e,function(e,o){r==e&&setCommandHint(o)})),markChanged()}),$("#cmd_reset").on("click",function(){loadConfiguration(),resetCommandHints()}),$("#cmd_ok").on("click",function(){var e,o,r,t,n=[],a=[];$.each($(".command"),function(s,l){e=l.id,o=$("#"+e+" option:selected").val(),r=o,"boolean"===(t=$("#"+e).attr("datatype"))?r="true"===r:"number"==t&&(r=parseInt(r)),a=[e,o,t],n.push(a)}),a=JSON.stringify(n),a={user:user,command:a},$.post("controller/configuration_save.php",a,function(e){markChanged(!1)})})}$(document).ready(function(){sura=new Suranadira({classEnabled:!1}),properties=sura.getProperties(),createControls(),loadConfiguration(),loadEvents()});